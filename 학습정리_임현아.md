# 5월 28일 2일차 BlockChain



| 팀           | 구성원         | 일정         | 발제자 | 주제                                                         |
| ------------ | -------------- | ------------ | ------ | ------------------------------------------------------------ |
| **BeatCoin** | 조원철, 임현아 | 2일차 (5/28) | 임현아 | 1.1 비트코인 암호 기초<br />1.2 비트코인이란<br />1.3 비트코인 네트워크 기초 |



## 주요 내용 요약

#### 1.1 비트코인 암호 기초

- ##### 해시함수

  > 어떤 메세지에 대해 짧고 일정한 길이 (128 ~ 512) 의 메세지를 반환하는 함수
 
  1. **일방향성**

     > 메세지(M)과 함수(H)를 통해 나온 값(H(M)) 은 1:1 관계를 갖는다.

  2. **역상 저항성**

     > H(X) = V 에서 V로 X를 찾을 수 없다. => 역함수를 구할 수 없다.

  3. **임의성**

     > 메세지(M) 값이 조금만 달라져도 완전히 다른 값이 생성된다.

- ##### 공개키 암호

  > 암호화에 사용하는 키를 두 개 생성한 후, 그 중 한 개는 **공개(public)**, 다른 한 개는 **비밀(private)** 로 보관
  > `공개 => 공개키`, `비밀 => 개인키`

  * **공개키(K+)** : 주소 생성과 서명 검증 => 공인 인증서와 같은 방식으로 누구나 볼 수 있다.
  * **개인키(K-)** : 서명 생성 => 개인만의 고유한 키로 다른 사람을 알 수 없다.
  * 일반적으로 개인키를 사용하여 암호화를 진행 후, 공개키를 사용하여 복호화를 한다.

- ##### 서명

  > 메세지를 보낼 때, 누가 보내는 지를 함께 보내기 위한 방법

  * **서명 생성**
    * 개인키를 사용하여 메세지(M)의 해시값(H(M))을 암호화
    * 메세지(M)와 서명(E(H(M), K-))을 전송한다.
      => 서명을 생성할 때, 어떤 메세지와 보내는 지(H(M)), 누가 보내는 지(K-)를 E로 묶어 생성한다.
    * `M + E(H(M), K-)` 형태로 전송
  * **서명 검증**
    * 수신한 `M + E(H(M), K-)` 를 다음과 같이 검증한다.
      1. `M`을 해시함수를 사용하여 `H(M)` 형태로 만든다.
      2. `E(H(M), K-)` 를 공개된 `K+`와 복호화(DE) 과정을 거쳐 H(M) 형태만 남긴다.
         `DE(E(H(M), K-), K+)` => `H(M)`
      3. *1*, *2* 의 결과 값이 같은지를 검증한다.
  * 활용
    * 거래 생성자 확인
    * 특정 주소의 코인 소유자 확인



#### 1.2 비트코인이란?

* ##### 비트코인(BTC)

  * 비트코인 네트워크에서 발행되는 통화의 이름
  * 비트코인 통화가 운영되는 네트워크 시스템 전체
    * 블록체인 (거래장부 - 트랜잭션이 담긴 블록을 체인으로 엮은 것)
    * 블록 전송을 위한 네트워크
    * 블록체인을 생성하고 검증하는 채굴자 집합


* ##### 비트코인의 출현

  * P2P 전자화폐 시스템
  * 공개키 기반의 주소에 대응되는 서명에 의한 증명
    

* ##### 비트코인의 특징

  * 모든 지불 거래 정보를 블록체인에 저장
  * 블록체인에서 승인된 거래 기록 변경 불가
  * 누구나 블록체인 생성에 참여 가능
  * 누구나 블록체인 유지 및 내역 확인 가능
  * Legder(원장 - 거래 승인, 전자 화폐 이동) 관리
  * 이중 지불 불가



#### 1.3 비트코인 네트워크 기초

* ##### 기존 금융 네트워크

  * 중앙기관에 의해 구축, 운영
  * 클라이언트 - 서버 네트워크

* ##### 비트코인 네트워크

  * 운영주체가 없이 참여자들이 자발적으로 구축, 운영
  * 참여자들의 컴퓨터를 연결한 P2P 네트워크
  * 누구든지 (node)로 참여가 가능 - 채굴, 거래소 등
  * 참여를 통한 인센티브로 비트코인을 제공.

* ##### 네트워크의 익명성

  * 암호학적으로 생성되는 비트코인의 주소를 사용하므로, 사용자가 누구인지 바인딩 하는 과정을 존재하지 않아 익명성이 보장됨

* ##### 비정상적인 참여자 존재 가능

  * 누구나 참여가 가능하므로, 불안정하고 속도가 느린 부실한 컴퓨터나, 악의적 사용자가 운연하는 악성 컴퓨터 노드가 존재할 수 있다.
  

---
  

# 5월 29일 3일차 BlockChain



| 팀           | 구성원         | 일정         | 발제자 | 주제                                                         |
| ------------ | -------------- | ------------ | ------ | ------------------------------------------------------------ |
| **BeatCoin** | 조원철, 임현아 | 3일차 (5/29) | 임현아 | 1.4 비트코인 전자화폐 거래개념 <br />1.5 비트코인 블록체인 개요 |


#### 1.4 비트코인 전자화폐 거래개념

* ##### 거래의 목표

  * P2P 거래

    > 모든 거래는 당사자간에 P2P방식으로 이루어짐

  * 안전하고 투명한 거래 

    > 모든 지불 거래 내역이 public ledger인 블록체인에 기록

* ##### 화폐 발행의 주체

  * 채굴자 

    > 블록을 생성, 체인으로 연결하는 참여자

  * `작업 증명 알고리즘` - 채굴 역량에 비례하는 확률로 임의의 채굴자를 자동으로 선정

  * 채굴자가 선정되면, 해당 채굴자의 주소로 블록 보상인 비트코인을 송신하는 거래 내역을 트랜잭션에 기록해 블록 첫번째에 등록 (**CoinBase**)

* ##### 화폐 소유자 증명

  * 소유자 증명 방식

    > * 지불 거래 생성시 소유자 증명 방식을 명시한다.
    예.) 수신자 주소에 대응되는 서명 제시를 요구
    > * locking script를 unlocking script 로 풀 수 있도록 한다.

- ##### 지불 거래

- - CoinBase

    ![img](https://lh5.googleusercontent.com/74vOXykI7FOfOTFepLd_3_JY3RuY19d2oyhZ8cNZQz2VbqY2LcNkh4-vgKyII_A3ZyOIBSL7FTDQ9T3P9HDfQCdQ-3moz3B0CG6CyrBr-zraCgtlQ2LF_lEZjj_lYR6XwdlmvXUf)
    입력값

  - > 해시값 : 출력값에 대한 해시값
    > 서명 : 소유자 증명을 위한 서명

  - 지불 거래
    ![img](https://lh4.googleusercontent.com/xrn4P7tjsMQU_yckx-szzXeCEmEAUdZ-KyzjphY5QWAgkfNa3IwRHMhX3Mm7KWMfbz9l57oMS8fSltXYs8jtSZAB49SH6IcPKe80LQB9lpYhpx5Ch5Cd3gWxnft9MsyxNtSwABi7)

  - - `입력값의 금액 - 출력값의 금액` = 수수료
    - 한번 해시포인터로 지정된 비트코인은 사용이 되었으므로 더이상 사용할 수 없다.
    - 출력값에는 `보내는 금액`, `주소`, `소유자 증명 방식` 기술

  - 지불 거래의 일반적인 형식
    ![img](https://lh3.googleusercontent.com/FjC0sfzdYRPmj2sEXxD9HUrc57QZ3x1kQ33tYk5En_lVCWHQyv1y41zTCUK8sNgPGWS5a6bfDdMIzHN5Yc0HReQSynXgyYZFY1FtrqBS13kGYS3SLXv6LIbiVEwGVb2gI_BGEuzU)

  - - UTXO 

      > 내 주소로 받았는데 아직 사용되지 않은 화폐
      > → 해시포인터로 지정되지 않은 화폐

    - STXO 

      > 받은 화폐중에 이미 사용된 화폐
      > → 해시포인터로 지정이 된 화폐를 의미.

    - 결과적으로,
      블록체인 상의 UTXO의 총합 = 발행된 비트코인의 총액,
      내 지갑의 모든 비트코인의 총액 = 내 주소의 UTXO의 총합.

- 이중 지불 거래 방지

- - 이중 지불이란?

    > STXO를 다시 사용하는 지불거래

  - UTXO 전체 단위로 사용 ⇒ 수신된 비트코인의 일부만 사용하는 것은 불가
    
    

#### 1.5 비트코인 블록체인 개요

- ##### 블록체인의 역할

- - 비트코인의 지불 거래 정보를 기록한 장부
  - 발행, 이동 내역을 보여주는 장부
  - P2P 거래를 가능하게 하는 원천

- ##### 블록체인의 목표

- - **완전성**

    > 모든 거래를 일관성있게 기록, 누구든지 모든 비트코인의 현황을 확인할 수 있다.

  - **안전성**

    > 비정산 거래 기록 불가, 승인된 거래 변경/교체 불가, 블록체인 파괴 불가

  - **분산성 / 비집중성**

    > 누구든지 참여 가능, 의존되지 않으며 일관성이 보장.

  - **투명성**

    > 누구나 블록체인 접근, 검증, 사용 가능.
    > 채굴자가 아니여도 접근 가능 (SPV노드)

- ##### 비트코인 네트워크 참여자

- - 풀 노드 참여자
  - 채굴 노드 참여자
  - SPV 노드

- ##### 비트코인

- - 블록

    > 일정 시간(대략 10분) 동안 교환되는 모든 거래를 검증한 후, 모아서 만든 자료구조 → 장부
    > 생성 후, 모든 네트워크 참여자에게 전달 ⇒ 자신의 블록체인에 수신된 블록을 연결

  - - 블록 크기 : 1Mbyte로 제한 (일반적으로 초당 7개의 거래)
      ⇒ 블록 전달 지연시간이 커지는 것을 방지

  - 블록 채굴자 결정

    > PoW (작업증명)에 가장 먼저 성공한 채굴자 ⇒ 그만큼 PC 성능이 좋아야함
    > 예.) 난이도 목표값보다 작은 해시값을 생성하는 넌스

  - - 생성한 블록 배포시에 해시값을 포함해, 채굴자가 성공한 것을 누구나 확인 가능하게 함

  - 블록 조작 불가
    ![img](https://lh5.googleusercontent.com/07udbAVI70PmgMWszgxASxfPeCCycBHevGbRLRllg7j3YfKh5sN6Zh2HfUmvRnOgjyS_JN4ejuRJqW1_q0Up-eJNBpt5Rc43A-6dc-vtmcPBfMlOqdboa2rZ2ii01AkFuzyH83BB)

  - - **51% Attack** : 51% 이상의 해시파워를 소유한 집단이 공격을 한다면 가능하겠지만, 현실적으로는 불가능하다.

- ##### SPV 노드

  > 블록 헤더(해시 포인터, 난이도 목표, 넌스, 머클 루트) 정보만 유지

- - 머클 트리 : 거래들을 모아놓은 해시 트리
    ![img](https://lh5.googleusercontent.com/DlnpEDF7nqEIJev3H9Ccf6klsKq6Ur_Li9tW1cL07ikti3Wx0jurDXLOqRRLr_Px4p_9VXabrIMg6cZT6uOQYT0c3xBX4hpWxOyf9KVBXyb_tLV4jIE5fh3S0QtgP-AC9Vu1Nis9)

  - 머클 경로 : 특정 거래의 존재 증명에 필요한 일련의 해시 노드

  - - 거래 k (Hk) 의 머클 경로 ⇒ HI → Hij → Hmnop → Habcdefgh

    - 계산 방법

      > `Hk` + `Hl` ⇒ `Hkl`
      > `Hkl` + `Hij` ⇒ `Hijkl`
      > `Hijkl` +`Hmnop` ⇒ `Hijklmnop`
      > `Hijklmnop` + `Habcdefgh` ⇒ `머클루트`

    - 머클 경로를 사용하면 굳이 머클 트리 전체를 저장할 필요가 없다.

    - 머클 경로의 크기 : log2N

  - SPV 노드의 거래 승인 확인

  - - 관심있는 거래의 머클 경로만 다운로드
      해시값 계산 결과와 자신이 보유한 블록 헤더의 머클 루트와 비교

 